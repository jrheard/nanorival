function add(acc, x) {
    return acc + x;
}

function main() {

    // generated by gen_counts.py:
    var COUNTS_BY_DAY = [877, 1503, 743, 1896, 955, 362, 1179, 1124, 849, 267, 417, 361, 0, 18, 550, 1149, 62, 629, 1123, 1025, 878, 0, 291, 762, 0, 891, 0, 628, 552, 909];

    var today = new Date();
    if (today.getMonth() > 10 || today.getFullYear() > 2025) {
        document.getElementById("day-summary").innerText = "NaNoRiVal 2025 is over! Did you win??";
        document.getElementById("cumulative-summary").remove()
        document.getElementById("progress-bar").remove()
        return;
    }

    var dayIndex = today.getDate() - 1;
    if (today.getHours() < 18) {
        // Keel wants each day's number to appear no sooner than 6pm.
        today.setDate(today.getDate() - 1);
        dayIndex -= 1;
    }

    if (dayIndex < 0) {
        document.getElementById("day-summary").innerText = "Your rival hasn't started yet, check back later!";
        document.getElementById("cumulative-summary").remove()
        document.getElementById("progress-bar").remove()
        return;
    }

    var todaysNumber = COUNTS_BY_DAY[dayIndex];
    var sumSoFar = COUNTS_BY_DAY.slice(0, dayIndex + 1).reduce(add, 0);

    document.getElementById("day").innerText = today.toLocaleDateString('en-us', { weekday: "long", month: "short", day: "numeric" });
    document.getElementById("num-words-today").innerText = todaysNumber.toLocaleString("en-us");
    document.getElementById("num-words-cumulative").innerText = sumSoFar.toLocaleString("en-us");


    var progressBarWidth = 800 * (sumSoFar / 20000);
    document.getElementById("inner").style.width = progressBarWidth + "px";
}
